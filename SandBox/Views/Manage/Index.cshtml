@model SandBox.Models.IndexViewModel
@{
    ViewBag.Title = "Zarządzaj";
}

<h2>@ViewBag.Title.</h2>

<p class="text-success">@ViewBag.StatusMessage</p>
<div>
    <h4>Zmień ustawienia konta</h4>
    <hr />
    <dl class="dl-horizontal">
        <dt>Hasło:</dt>
        <dd>
            [
            @if (Model.HasPassword)
            {
                @Html.ActionLink("Zmień hasło", "ChangePassword")
            }
            else
            {
                @Html.ActionLink("Utwórz", "SetPassword")
            }
            ]
        </dd>
        <dt>Logowania zewnętrzne:</dt>
        <dd>
            @Model.Logins.Count [
            @Html.ActionLink("Zarządzaj", "ManageLogins") ]
        </dd>

        <dt>Uwierzytelnianie dwuetapowe:</dt>
        <dd>
            <p>
                Nie skonfigurowano dostawców uwierzytelniania dwuskładnikowego. Zapoznaj się z <a href="https://go.microsoft.com/fwlink/?LinkId=403804">tym artykułem</a>,
                aby uzyskać szczegółowe informacje dotyczące konfigurowania tej aplikacji ASP.NET do obsługi uwierzytelniania dwuskładnikowego.
            </p>

        </dd>
    </dl>

    <hr />
    <h4>Profile picture</h4>

    <img src="data:image;base64,@System.Convert.ToBase64String(Model.ImageData)" height="200" alt="You haven't uploaded a photo yet" id="image-selected" />

    <form class="mt-2 mb-2" action="@Url.Action("UploadProfileImage")" method="post" enctype="multipart/form-data">
        @Html.AntiForgeryToken()
        <div class="input-group w-50">
            <div class="custom-file">
                <input type="file" name="image" class="custom-file-input" id="js-photo-upload" />
                <label class="custom-file-label">Choose a photo...</label>
            </div>
        </div>

        <button type="submit" class="btn btn-primary mt-2">Upload</button>
    </form>

</div>

@section scripts
{
    <script>
        $(document).ready(function () {
            $("#js-photo-upload").on("change", function () {

                if (this.files && this.files[0]) {
                    console.log("event");
                    var reader = new FileReader();

                    reader.onload = function (e) {
                        $("#image-selected").attr("src", e.target.result);
                    }

                    reader.readAsDataURL(this.files[0]);
                }
            });
        });
    </script>
}